<?php

namespace App\Plugins\AccountingVulnerabilities\Services;

use App\Plugins\AccountingVulnerabilities\Models\Vulnerability;
use App\Plugins\AccountingVulnerabilities\Models\VulnerabilitySoft;

class VulnerabilityHelper
{
    public static function create(
        string $name,
        string $description,
        string $bdu,
        string $cve,
        string $vector,
        string $grade,
        string $elimination
    ): Vulnerability {
        $vulnerability = new Vulnerability();

        $vulnerability->fill([
            'name' => $name,
            'description' => $description,
            'bdu' => $bdu,
            'cve' => $cve,
            'vector' => $vector,
            'grade' => $grade,
            'elimination' => $elimination
        ])->save();

        return $vulnerability;
    }

    public static function addSoft(Vulnerability $vulnerability, string $name): VulnerabilitySoft
    {
        $soft = new VulnerabilitySoft();
        $soft->fill(['name' => $name, 'vulnerability_id' => $vulnerability->id]);
        $soft->save();
        return $soft;
    }
}
